<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <title>Stuttgart Talks: Game</title>
    <link rel="stylesheet" href="main.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
</head>
<body class="game-body">
    <canvas id="snowCanvas"></canvas>
    
    <div class="game-wrap">
        <header class="game-header">
            <div class="header-left">
                <div class="avatar-circle" id="myTeamAvatar"></div>
                <div>
                    <span id="myNameHeader" class="player-name-header">...</span>
                    <div style="font-size: 0.8rem; opacity: 0.8;">
                        <strong id="myTeamName">...</strong> ‚Ä¢ <span id="myPlayerRole">...</span>
                    </div>
                </div>
            </div>
            <div class="header-right">
                <button class="icon-btn" onclick="openItemsGuide()">üìñ</button>
                <button id="btnShowTrades" class="secondary hidden" onclick="openIncomingTrades()">–û–±–º–µ–Ω ü§ù</button>
                <button id="btnLogout" class="icon-btn" style="color:var(--accent-red)">üö™</button>
            </div>
        </header>

        <main class="game-main">
            <aside class="inventory-panel card">
                <h2>üéí –†—é–∫–∑–∞–∫</h2>
                <ul id="inventoryList" class="inventory-list">
                    <li class="muted">–ü—É—Å—Ç–æ...</li>
                </ul>
            </aside>

            <section class="map-window card">
                <h2>üó∫Ô∏è –õ–æ–∫–∞—Ü–∏—è</h2>
                <div class="map-placeholder">
                    <p>–ö–∞—Ä—Ç–∞ –º–µ—Å—Ç–Ω–æ—Å—Ç–∏</p>
                </div>
            </section>

            <section class="bottom-panel">
                <div class="tasks-panel card">
                    <h2 style="display:flex; justify-content:space-between; align-items:center;">
                        –ú–∏—Å—Å–∏–∏ üìú 
                        <span id="taskProgress" style="font-size:0.9rem; color:var(--accent-cyan)">0%</span>
                    </h2>
                    <div class="tasks-container">
                        <table class="tasks-table">
                            <thead>
                                <tr>
                                    <th style="width: 30px;">‚úî</th>
                                    <th>–¶–µ–ª—å</th>
                                    <th style="width: 30px; text-align:center;">üéÅ</th>
                                </tr>
                            </thead>
                            <tbody id="tasksTableBody">
                                <tr><td colspan="3" class="muted" style="padding:10px;">–ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="team-info-panel card">
                    <h2>–°–æ—Å—Ç–∞–≤ (<span id="myTeamMembersCount">0</span>)</h2>
                    <ul id="currentTeamMembersList" class="member-list"></ul>
                </div>
            </section>
        </main>
    </div>

    <div id="itemsGuideModal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header-strip"></div>
            <div class="modal-top-row">
                <h3 class="modal-title">üìñ –ü–†–ï–î–ú–ï–¢–´</h3>
                <button class="modal-close" onclick="closeItemsGuide()">√ó</button>
            </div>
            <div class="tasks-container" style="max-height: 400px; overflow-y: auto;">
                <table class="tasks-table">
                    <tbody id="itemsTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="tradeModal" class="modal-backdrop hidden">
        <div class="modal-content">
             <div class="modal-header-strip"></div>
             <div class="modal-top-row">
                <h3 class="modal-title">ü§ù –ü–†–ï–î–õ–û–ñ–ò–¢–¨</h3>
                <button class="modal-close" onclick="closeTradeModal()">√ó</button>
            </div>
            
            <label class="label-accent">1. –ö–æ–º—É:</label> 
            <select id="tradeTargetTeam" class="modal-input"></select>
            
            <label class="label-accent" style="color:var(--accent-cyan)">2. –û—Ç–¥–∞–µ–º:</label> 
            <select id="tradeOfferSelect" class="modal-input"></select>
            
            <label class="label-accent" style="color:var(--accent-gold)">3. –ü—Ä–æ—Å–∏–º:</label> 
            <select id="tradeRequestSelect" class="modal-input"></select>
            
            <button class="start-button" onclick="sendTradeRequest()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>  

    <div id="incomingTradesModal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="modal-header-strip"></div>
            <div class="modal-top-row">
                <h3 class="modal-title">üì® –í–•–û–î–Ø–©–ò–ï</h3>
                <button class="modal-close" onclick="closeIncomingTrades()">√ó</button>
            </div>
            <div id="incomingTradesList"></div>
        </div>
    </div>

    <script type="module" src="game.js"></script>
</body>
</html>